# Хранимые процедуры

Хранимые процедуры позволяют исполнять код на стороне сервера API без передачи кода процедуры по сети. Используйте хранимые процедуры в мини-приложениях для мобильных платформ, чтобы экономить трафик. Вы также можете передавать любые значения из мини-приложения в хранимую процедуру, чтобы добиться желаемой логики.

Чтобы перейти в раздел, откройте Мои приложения → Редактировать → Хранимые процедуры.

Добавление хранимой процедуры

Внешний вид хранимой процедуры
Добавление хранимой процедуры

1. Нажмите на кнопку Добавить новую процедуру.
2. Укажите название процедуры.
3. Выберите версию API.
4. Добавьте код процедуры и нажмите кнопку Сохранить.

Код хранимой процедуры

Процедуры нужно писать на языке программирования VKScript. Подробная информация о синтаксисе и возможностях этого языка с примерами находится в описании метода execute.

Вызов хранимой процедуры из мини-приложения

Переданные параметры будут доступны внутри кода процедуры в виде полей объекта Args. Например, если вы передали параметр user, то значение этого параметра будет доступно в поле Args.user.

VK Bridge

Хранимую процедуру можно вызвать с помощью события VKWebAppCallAPIMethod.

JavaScript
bridge.send("VKWebAppCallAPIMethod", {
method: "execute.ИМЯ_ПРОЦЕДУРЫ",
params: {
НАЗВАНИЕ_ПАРАМЕТРА1: "ЗНАЧЕНИЕ_ПАРАМЕТРА1",
НАЗВАНИЕ_ПАРАМЕТРА2: "ЗНАЧЕНИЕ_ПАРАМЕТРА2",
v: "ВЕРСИЯ_API",
func_v: "ВЕРСИЯ_ПРОЦЕДУРЫ",
access_token: "КЛЮЧ_ДОСТУПА"
}
});

POST-запрос

Хранимую процедуру можно вызвать с помощью метода execute. Для этого отправьте POST-запрос как в примере ниже.

POST https://api.vk.com/method/execute.ИМЯ_ПРОЦЕДУРЫ?access_token=КЛЮЧ_ДОСТУПА&v=ВЕРСИЯ_API&func_v=ВЕРСИЯ_ПРОЦЕДУРЫ&НАЗВАНИЕ_ПАРАМЕТРА1=ЗНАЧЕНИЕ_ПАРАМЕТРА1&НАЗВАНИЕ_ПАРАМЕТРА2=ЗНАЧЕНИЕ_ПАРАМЕТРА2 HTTP/1.1

Добавление версии хранимой процедуры

Можно добавить только две версии процедуры. Удалить версию можно лишь через удаление процедуры целиком.

1. Нажмите на значок + справа от названия процедуры.
2. Выберите версию процедуры.
3. Выберите версию API.
4. Нажмите кнопку Сохранить.

Удаление хранимой процедуры

Удаление процедуры — это необратимая операция.

Чтобы удалить процедуру:

1. Нажмите кнопку Удалить.
2. Нажмите кнопку Удалить во всплывающем окне.

Важно! После удаления процедура исчезнет из списка и её нельзя будет восстановить.